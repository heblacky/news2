"use strict";!function(){var i={initialize:function(){this.initializeSsoTools(),this.addEmailToMenu()},initializeSsoTools:function(){i.debug()&&console.log("DEBUG: MNG_SSO_TOOLS_GLOBAL_START"),this.startTimer(),"undefined"!=typeof MNG_SSO_CONNEXT_EVENT_TIMING_ANALYTICS&&(i.debug()&&console.log("DEBUG: MNG_SSO_CONNEXT_EVENT_TIMING_ANALYTICS global detected"),this.connextEvents())},debug:function(){var o=!1;return o="undefined"!=typeof MNG_SSO_TOOLS_DEBUG?!0:o},pushToGA:function(o){void 0!==window.MG2DL?(i.debug()&&console.log("DEBUG: MG2DL object available; payload to push: "+JSON.stringify(o)),window.MG2DL.push(o)):(i.debug()&&(console.log("DEBUG: MG2DL not available, setting 5-second timeout to retry"),console.log("DEBUG: Payload to push - "+JSON.stringify(o))),setTimeout(i.pushToGA,5e3,o)),void 0!==window.dataLayer&&(i.debug()&&console.log("DEBUG: MNGDL object available; payload to push: "+JSON.stringify(o.Auth0SocialConnection)),"undefined"!=typeof dataLayer)&&dataLayer.push({Auth0SocialConnection:o.Auth0SocialConnection})},startTimer:function(){var o=this,n=(o.debug()&&console.log("DEBUG: hit startTimer function"),Date.now());o.debug()&&console.log("DEBUG: start timer: "+JSON.stringify(n)),window.MNG_SSO_TOOLS_GLOBAL_START_TIME=n,performance.mark("startTimer"),o.connextLoginButtonTimer(n)},connextLoginButtonTimer:function(n){var e=this;e.debug()&&console.log("DEBUG: hit connextLoginButtonTimer function"),e.debug()&&console.log("DEBUG: start timer: "+JSON.stringify(n)),document.addEventListener("onFinish",function(){performance.mark("connext_onFinish");var o=Date.now(),o=(e.debug()&&console.log("DEBUG: stop timer: "+JSON.stringify(o)),o-n);e.debug()&&console.log("DEBUG: diff timer: "+JSON.stringify(o)),"undefined"!=typeof dataLayer&&dataLayer.push({"Timer.LoginButtonShown":o})})},getCookie:function(o){for(var n,e=o+"=",i=void 0,o=void 0,t=document.cookie.split(";"),l=0;l<t.length;l++){for(var s=t[l];" "==s.charAt(0);)s=s.substring(1,s.length);0==s.indexOf(e)&&(i=s.substring(e.length,s.length))}return void 0!==i?(o=(1<i.match(n=/(^.*\|]*)/g)[0].split("|").length-1?i.match(n)[0].replace("|","-"):i.match(n)[0]).replace("|",""),this.debug()&&console.log("DEBUG: auth0 user state source "+o),o):(this.debug()&&console.log("DEBUG: auth0 user state source unknown"),"unknown")},connextEvents:function(){var e=this,n=(e.debug()&&console.log("DEBUG: hit connextEvents function"),Date.now()),i=void 0,t=void 0,l=void 0,s=void 0,a=void 0,r=void 0;document.addEventListener("onInit",function(){performance.mark("connext_onInit"),e.debug()&&console.log("DEBUG: hit onInit event listener"),t=Date.now()-n;var o={event:"setTimer",onRunTimer:l,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onRun payload: "+JSON.stringify(o)),e.pushToGA(o),window.DD_RUM&&window.DD_RUM.addTiming("onInit"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onRun",function(){performance.mark("connext_onRun"),e.debug()&&console.log("DEBUG: hit onRun event listener");var o={event:"setTimer",onRunTimer:l=Date.now()-n,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onRun payload: "+JSON.stringify(o)),e.pushToGA(o),window.DD_RUM&&window.DD_RUM.addTiming("onRun"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onDynamicMeterFound",function(){performance.mark("connext_onDynamicMeterFound"),e.debug()&&console.log("DEBUG: hit onDynamicMeterFound event listener"),s=Date.now()-n;var o={event:"setTimer",onRunTimer:l,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onDynamicMeterFoundTimer payload: "+JSON.stringify(o)),e.pushToGA(o),window.DD_RUM&&window.DD_RUM.addTiming("onDynamicMeterFound"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onLoggedIn",function(){performance.mark("connext_onLoggedIn"),e.debug()&&console.log("DEBUG: hit onLoggedIn event listener"),i=Date.now()-n;var o={event:"setTimer",onRunTimer:l,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onRun payload: "+JSON.stringify(o)),e.pushToGA(o),window.DD_RUM&&window.DD_RUM.addTiming("onLoggedIn"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onPaywallShown",function(o){performance.mark("connext_onPaywallShown"),e.debug()&&console.log("DEBUG: hit onPaywallShown event listener"),Date.now(),r=e.getCookie("auth0_sub");var n={event:"setTimer",onRunTimer:l,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onRun payload: "+JSON.stringify(n)),e.pushToGA(n),window.DD_RUM&&window.DD_RUM.addTiming("onPaywallShown"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onFinish",function(){e.debug()&&console.log("DEBUG: hit onFinish event listener"),a=Date.now()-n,r=e.getCookie("auth0_sub");var o={event:"setTimer",onRunTimer:l,onDynamicMeterFoundTimer:s,onLoggedInTimer:i,onInitTimer:t,onFinishTimer:a,Auth0SocialConnection:r};e.debug()&&console.log("DEBUG: onRun payload: "+JSON.stringify(o)),e.pushToGA(o),window.DD_RUM&&window.DD_RUM.addTiming("onFinish"),e.debug()&&console.log("DEBUG: onRun payload pushed"),e.debug()&&(console.log("DEBUG: events pushed with the onFinish event listener"),!1===isNaN(i)?console.log("DEBUG: onLoggedInTimer "+Math.floor(i/1e3)+" seconds - ( "+i+" )"):console.log("DEBUG: onLoggedInTimer is not available"),!1===isNaN(t)?console.log("DEBUG: onInitTimer "+Math.floor(t/1e3)+" seconds - ( "+t+" )"):console.log("DEBUG: onInitTimer is not available"),!1===isNaN(l)?console.log("DEBUG: onRunTimer "+Math.floor(l/1e3)+" seconds - ( "+l+" )"):console.log("DEBUG: onRunTimer is not available"),!1===isNaN(s)?console.log("DEBUG: onDynamicMeterFoundTimer "+Math.floor(s/1e3)+" seconds - ( "+s+" )"):console.log("DEBUG: onDynamicMeterFoundTimer is not available"),!1===isNaN(a)?console.log("DEBUG: onFinishTimer "+Math.floor(a/1e3)+" seconds - ( "+a+" )"):console.log("DEBUG: onFinishTimer is not available"))}),document.addEventListener("onConversationDetermined",function(){window.DD_RUM&&window.DD_RUM.addTiming("onConversationDetermined")})},addEmailToMenu:function(){var e=this;window.addEventListener("load",function(){var o=null;if("undefined"!=typeof MNGPaywall){var n=MNGPaywall.findUserInfo();null!==n&&null!==n.email&&(o=n.email),i.debug()&&console.log("Piano provided an email of "+o)}else{if(!e.getCookie("auth0_sub")||"undefined"==typeof Connext)return;var n=Connext.Storage.GetUserProfile();null!=n&&(o=n.email,i.debug())&&console.log("Connext provided an email of "+o)}null!==o&&(n="Logout | "+o,$(".status-bar-menu > .log-out-button > a").text(n))})}};i.initialize()}();